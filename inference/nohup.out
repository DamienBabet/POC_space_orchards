Traceback (most recent call last):
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 114, in _error_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/aiobotocore/client.py", line 412, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidAccessKeyId) when calling the PutObject operation: The Access Key Id you provided does not exist in our records.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/onyxia/work/hackathon-ntts-2025/inference/main.py", line 43, in <module>
    with fs.open(filepath_out, 'wb') as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/fsspec/spec.py", line 2227, in __exit__
    self.close()
  File "/opt/conda/lib/python3.12/site-packages/fsspec/spec.py", line 2178, in close
    self.flush(force=True)
  File "/opt/conda/lib/python3.12/site-packages/fsspec/spec.py", line 2041, in flush
    if self._upload_chunk(final=force) is not False:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 2430, in _upload_chunk
    self.commit()
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 2446, in commit
    write_result = self.fs.touch(self.path, **self.kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/fsspec/asyn.py", line 118, in wrapper
    return sync(self.loop, func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/fsspec/asyn.py", line 103, in sync
    raise return_result
  File "/opt/conda/lib/python3.12/site-packages/fsspec/asyn.py", line 56, in _runner
    result[0] = await coro
                ^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 1108, in _touch
    write_result = await self._call_s3(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 371, in _call_s3
    return await _error_wrapper(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.12/site-packages/s3fs/core.py", line 146, in _error_wrapper
    raise err
PermissionError: The Access Key Id you provided does not exist in our records.
